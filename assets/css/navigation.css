@layer components {
  .open-menu {
    @apply overflow-y-hidden;
  }

  .menu-button {
    @apply relative w-12 h-12 bg-background text-foreground border border-foreground/30 hover:border-primary-600 hover:bg-primary-600 hover:text-foreground transition-all duration-300 rounded-lg flex items-center justify-center;
  }

  /* Scale up menu button by 1.3x on smaller screens */
  @media (max-width: 767px) {
    .menu-button {
      @apply w-[54px] h-[54px]; /* 48px * 1.3 = 62.4px */
    }
  }

  .open-menu .menu-button {
    @apply bg-background;
  }

  .menu-button i {
    @apply relative w-5 h-5 flex items-center justify-center;
  }

  /* Scale up menu button icon on smaller screens */
  @media (max-width: 767px) {
    .menu-button i {
      @apply w-[26px] h-[26px]; /* 20px * 1.3 = 26px */
    }
  }

  .menu-button i:before,
  .menu-button i:after {
    @apply absolute w-4 h-0.5 bg-foreground transition-all duration-300 ease-in-out;
    content: "";
  }

  /* Scale up hamburger lines on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:before,
    .menu-button i:after {
      @apply w-[21px] h-[2.6px]; /* 16px * 1.3 = 20.8px, 2px * 1.3 = 2.6px */
    }
  }

  .menu-button:hover i:before,
  .menu-button:hover i:after {
    @apply bg-gray-100;
  }

  .menu-button i:before {
    @apply -translate-y-1;
  }

  /* Scale up hamburger line spacing on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:before {
      @apply -translate-y-[5px]; /* 4px * 1.3 = 5.2px */
    }
  }

  .menu-button i:after {
    @apply translate-y-1;
  }

  /* Scale up hamburger line spacing on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:after {
      @apply translate-y-[5px]; /* 4px * 1.3 = 5.2px */
    }
  }

  /* X state when menu is open */
  .open-menu .menu-button i:before {
    @apply translate-y-0 rotate-45;
  }

  .open-menu .menu-button i:after {
    @apply translate-y-0 -rotate-45;
  }

  .menu {
    @apply fixed top-3 left-3 bg-primary-500 rounded-lg shadow-xl opacity-0 pointer-events-none transition-all duration-300 ease-in-out transform scale-95 origin-top-left;
    min-width: 200px;
  }

  /* Scale up menu on smaller screens */
  @media (max-width: 767px) {
    .menu {
      min-width: 260px; /* 200px * 1.3 = 260px */
    }
  }

  .open-menu .menu {
    @apply opacity-100 pointer-events-auto scale-100;
  }

  .menu__header {
    @apply p-4 border-b border-primary-500 flex items-center justify-between;
  }

  /* Scale up menu header padding on smaller screens */
  @media (max-width: 767px) {
    .menu__header {
      @apply p-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__logo {
    @apply text-background;
  }

  .menu__logo svg {
    @apply w-8 h-8;
  }

  .menu__close {
    @apply w-8 h-8 bg-primary-500 hover:bg-primary-600 rounded flex items-center justify-center transition-colors duration-200;
  }

  /* Scale up menu close button on smaller screens */
  @media (max-width: 767px) {
    .menu__close {
      @apply w-[42px] h-[42px] -left-2 -top-2; /* 32px * 1.3 = 41.6px */
    }
  }

  .menu__close i {
    @apply relative w-4 h-4 flex items-center justify-center;
  }

  /* Scale up menu close icon on smaller screens */
  @media (max-width: 767px) {
    .menu__close i {
      @apply w-[21px] h-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__close i:before,
  .menu__close i:after {
    @apply absolute w-3 h-0.5 bg-primary-900;
    content: "";
  }

  /* Scale up menu close icon lines on smaller screens */
  @media (max-width: 767px) {
    .menu__close i:before,
    .menu__close i:after {
      @apply w-[16px] h-[2.6px]; /* 12px * 1.3 = 15.6px, 2px * 1.3 = 2.6px */
    }
  }

  .menu__close i:before {
    @apply rotate-45;
  }

  .menu__close i:after {
    @apply -rotate-45;
  }

  .menu__list {
    @apply list-none p-0 m-0;
  }

  .menu__item {
    @apply border-b border-primary-500 last:border-b-0;
  }

  .menu__link {
    @apply block px-4 py-3 text-background hover:bg-primary-600 transition-colors duration-200 text-base font-normal capitalize no-underline;
  }

  /* Scale up menu link padding and font size on smaller screens */
  @media (max-width: 767px) {
    .menu__link {
      @apply px-[21px] py-[16px]; /* 16px * 1.3 = 20.8px, 12px * 1.3 = 15.6px, 16px * 1.3 = 20.8px */
    }
  }

  .menu__link:hover {
    @apply bg-primary-700 text-foreground;
  }

  .menu__link.active {
    @apply bg-white text-background;
  }

  .menu__social {
    @apply p-4 border-t border-primary-500 flex gap-4;
  }

  /* Scale up menu social section on smaller screens */
  @media (max-width: 767px) {
    .menu__social {
      @apply p-[21px] gap-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__social a {
    @apply text-background hover:text-gray-100 transition-colors duration-200;
  }

  .menu__social svg {
    @apply w-5 h-5;
  }

  /* Scale up social icons on smaller screens */
  @media (max-width: 767px) {
    .menu__social svg {
      @apply w-[26px] h-[26px]; /* 20px * 1.3 = 26px */
    }
  }
}

.ui-navbar {
  @apply fixed top-3 left-3 z-50;
}

.open-menu .ui-navbar {
  @apply z-[999];
}

/* Hide the old navigation structure when not needed */
.navigation {
  @apply hidden;
}

.open-menu .navigation {
  @apply hidden;
}

.branding {
  @apply relative;
}

.site-title,
.site-logo {
  @apply hidden;
}

.navigation .logo {
  @apply block w-[42px] h-auto my-0 mx-auto md:p-0 text-background;
}

.open-menu .navigation .logo {
  @apply hidden;
}

.navigation .logo path {
  @apply fill-current;
}

.navigation .navigation-list .logo {
  @apply w-[56px] md:w-[72px] ml-0 mr-auto;
}

.navigation .social {
  @apply flex gap-4 pl-4 font-serif text-[16px] leading-tight;
}

.navigation .social p {
  @apply text-[12px] text-muted leading-relaxed font-sans mr-4;
}

.navigation .social a {
  @apply text-highlight underline underline-offset-4;
}

.navigation .social svg {
  @apply fill-current;
}

/* ============================================
   SITE NAVBAR (Shared between homepage & internal pages)
   ============================================ */
.site-navbar {
  @apply fixed top-0 left-0 right-0 z-50 flex flex-col lg:flex-row items-center justify-between px-6 py-6 lg:px-16;
  background: transparent;
  transition: background-color 0.3s ease;
}

.site-navbar.scrolled {
  background: rgba(30, 30, 30, 0.3);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.site-navbar.scrolled .site-logo-img {
  filter: brightness(0) invert(1);
  transition: filter 0.3s ease;
}

.site-logo-link {
  @apply no-underline;
}

.site-logo-text {
  @apply text-white font-heading text-2xl font-semibold tracking-tight no-underline;
  font-variation-settings: "wght" 600, "wdth" 125;
}

.site-logo-img {
  @apply h-9 w-auto;
  transition: filter 0.3s ease;
}

.nav-links {
  @apply hidden lg:flex items-center gap-8;
}

.nav-link {
  @apply text-white text-base font-sans no-underline relative pb-2;
  font-weight: 300;
  transition: all 0.2s ease;
}

.nav-link:hover {
  @apply text-white no-underline;
}

.nav-link.active {
  @apply font-bold;
}

.nav-link.active::after {
  content: "";
  @apply absolute bottom-0 left-0 right-0 h-[3px];
  background: var(--color-green-accent);
}

.nav-cta {
  @apply btn btn-bright btn-sm;
}

/* Mobile Menu Pull Tab - appears below logo */
.mobile-menu-btn {
  @apply lg:hidden flex items-center justify-center bg-transparent border-0 cursor-pointer;
  padding: 4px 8px 2px;
  margin-top: 8px;
  transition: all 0.2s ease;
}

.mobile-menu-handle {
  @apply block rounded-full;
  width: 26px;
  height: 4px;
  background: rgba(255, 255, 255, 0.6);
  transition: background 0.2s ease;
}

.mobile-menu-btn:hover .mobile-menu-handle,
.mobile-menu-btn.open .mobile-menu-handle {
  background: rgba(255, 255, 255, 0.9);
}

/* Responsive navbar adjustments */
@media (max-width: 1024px) {
  .nav-links {
    @apply hidden;
  }

  .nav-cta {
    @apply hidden lg:inline-flex;
  }
}

/* ============================================
   INTERNAL PAGE NAVBAR VARIANT
   Light background with dark text
   ============================================ */
body:not(.home) .site-navbar .nav-link {
  @apply text-gray-700;
}

body:not(.home) .site-navbar .nav-link:hover {
  @apply text-gray-900 no-underline;
}

body:not(.home) .site-navbar .mobile-menu-handle {
  background: rgba(0, 0, 0, 0.4);
}

body:not(.home) .site-navbar .mobile-menu-btn:hover .mobile-menu-handle,
body:not(.home) .site-navbar .mobile-menu-btn.open .mobile-menu-handle {
  background: rgba(0, 0, 0, 0.7);
}

/* When scrolled on internal pages, keep white text */
body:not(.home) .site-navbar.scrolled .nav-link {
  @apply text-white;
}

body:not(.home) .site-navbar.scrolled .nav-link:hover {
  @apply text-white no-underline;
}

body:not(.home) .site-navbar.scrolled .mobile-menu-handle {
  background: rgba(255, 255, 255, 0.6);
}

body:not(.home)
  .site-navbar.scrolled
  .mobile-menu-btn:hover
  .mobile-menu-handle {
  background: rgba(255, 255, 255, 0.9);
}

/* ============================================
   MOBILE MENU (Pull-down Sheet)
   ============================================ */
.mobile-menu {
  @apply fixed left-0 right-0 z-[60] flex flex-col items-center lg:hidden;
  top: 0;
  background: #181818;
  transform: translateY(-100%);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
  padding: 40px 24px 20px;
  border-radius: 0 0 16px 16px;
}

.mobile-menu.open {
  transform: translateY(0);
}

/* CTA button at top of menu */
.mobile-menu-cta {
  @apply mb-8;
}

.mobile-menu-cta .btn {
  font-size: 16px;
  padding: 16px 24px;
}

/* Navigation links */
.mobile-menu-links {
  @apply flex flex-col items-center gap-0 w-full;
}

.mobile-menu-link {
  @apply text-white font-heading no-underline py-3 text-center w-full;
  font-size: 23px;
  font-variation-settings: "wght" 300, "wdth" 125;
  opacity: 0;
  transform: translateY(-8px);
  transition: opacity 0.2s ease, transform 0.2s ease, color 0.2s ease;
}

.mobile-menu-link.active {
  font-variation-settings: "wght" 700, "wdth" 125;
  position: relative;
}

.mobile-menu-link.active::after {
  content: "";
  @apply absolute left-1/2 -translate-x-1/2 h-[3px] rounded-full;
  bottom: 6px;
  width: 100%;
  max-width: 114px;
  background: var(--color-green-accent);
}

.mobile-menu.open .mobile-menu-link {
  opacity: 1;
  transform: translateY(0);
}

/* Stagger the link animations */
.mobile-menu.open .mobile-menu-link:nth-child(1) {
  transition-delay: 0.08s;
}
.mobile-menu.open .mobile-menu-link:nth-child(2) {
  transition-delay: 0.12s;
}
.mobile-menu.open .mobile-menu-link:nth-child(3) {
  transition-delay: 0.16s;
}
.mobile-menu.open .mobile-menu-link:nth-child(4) {
  transition-delay: 0.2s;
}
.mobile-menu.open .mobile-menu-link:nth-child(5) {
  transition-delay: 0.24s;
}
.mobile-menu.open .mobile-menu-link:nth-child(6) {
  transition-delay: 0.28s;
}

.mobile-menu-link:hover,
.mobile-menu-link:active {
  color: var(--color-green-accent);
}

/* Logo at bottom of menu */
.mobile-menu-logo {
  @apply mt-8;
}

.mobile-menu-logo img {
  height: 36px;
  width: auto;
  filter: brightness(0) invert(1);
}

/* Pull handle at bottom */
.mobile-menu-handle-bottom {
  @apply mt-6 rounded-full;
  width: 26px;
  height: 4px;
  background: rgba(255, 255, 255, 0.4);
}

/* Overlay behind menu */
.mobile-menu-overlay {
  @apply fixed inset-0 bg-black/50 z-30 lg:hidden;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.mobile-menu-overlay.open {
  opacity: 1;
  visibility: visible;
}
