@layer components {
  .open-menu {
    @apply overflow-y-hidden;
  }

  .menu-button {
    @apply relative w-12 h-12 bg-bg text-fg border border-fg/30 hover:border-primary-600 hover:bg-primary-600 hover:text-fg transition-all duration-300 rounded-lg flex items-center justify-center;
  }

  /* Scale up menu button by 1.3x on smaller screens */
  @media (max-width: 767px) {
    .menu-button {
      @apply w-[54px] h-[54px]; /* 48px * 1.3 = 62.4px */
    }
  }

  .open-menu .menu-button {
    @apply bg-bg;
  }

  .menu-button i {
    @apply relative w-5 h-5 flex items-center justify-center;
  }

  /* Scale up menu button icon on smaller screens */
  @media (max-width: 767px) {
    .menu-button i {
      @apply w-[26px] h-[26px]; /* 20px * 1.3 = 26px */
    }
  }

  .menu-button i:before,
  .menu-button i:after {
    @apply absolute w-4 h-0.5 bg-fg transition-all duration-300 ease-in-out;
    content: "";
  }

  /* Scale up hamburger lines on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:before,
    .menu-button i:after {
      @apply w-[21px] h-[2.6px]; /* 16px * 1.3 = 20.8px, 2px * 1.3 = 2.6px */
    }
  }

  .menu-button:hover i:before,
  .menu-button:hover i:after {
    @apply bg-gray-100;
  }

  .menu-button i:before {
    @apply -translate-y-1;
  }

  /* Scale up hamburger line spacing on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:before {
      @apply -translate-y-[5px]; /* 4px * 1.3 = 5.2px */
    }
  }

  .menu-button i:after {
    @apply translate-y-1;
  }

  /* Scale up hamburger line spacing on smaller screens */
  @media (max-width: 767px) {
    .menu-button i:after {
      @apply translate-y-[5px]; /* 4px * 1.3 = 5.2px */
    }
  }

  /* X state when menu is open */
  .open-menu .menu-button i:before {
    @apply translate-y-0 rotate-45;
  }

  .open-menu .menu-button i:after {
    @apply translate-y-0 -rotate-45;
  }

  .menu {
    @apply fixed top-3 left-3 bg-primary-500 rounded-lg shadow-xl opacity-0 pointer-events-none transition-all duration-300 ease-in-out transform scale-95 origin-top-left;
    min-width: 200px;
  }

  /* Scale up menu on smaller screens */
  @media (max-width: 767px) {
    .menu {
      min-width: 260px; /* 200px * 1.3 = 260px */
    }
  }

  .open-menu .menu {
    @apply opacity-100 pointer-events-auto scale-100;
  }

  .menu__header {
    @apply p-4 border-b border-primary-500 flex items-center justify-between;
  }

  /* Scale up menu header padding on smaller screens */
  @media (max-width: 767px) {
    .menu__header {
      @apply p-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__logo {
    @apply text-bg;
  }

  .menu__logo svg {
    @apply w-8 h-8;
  }

  .menu__close {
    @apply w-8 h-8 bg-primary-500 hover:bg-primary-600 rounded flex items-center justify-center transition-colors duration-200;
  }

  /* Scale up menu close button on smaller screens */
  @media (max-width: 767px) {
    .menu__close {
      @apply w-[42px] h-[42px] -left-2 -top-2; /* 32px * 1.3 = 41.6px */
    }
  }

  .menu__close i {
    @apply relative w-4 h-4 flex items-center justify-center;
  }

  /* Scale up menu close icon on smaller screens */
  @media (max-width: 767px) {
    .menu__close i {
      @apply w-[21px] h-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__close i:before,
  .menu__close i:after {
    @apply absolute w-3 h-0.5 bg-primary-900;
    content: "";
  }

  /* Scale up menu close icon lines on smaller screens */
  @media (max-width: 767px) {
    .menu__close i:before,
    .menu__close i:after {
      @apply w-[16px] h-[2.6px]; /* 12px * 1.3 = 15.6px, 2px * 1.3 = 2.6px */
    }
  }

  .menu__close i:before {
    @apply rotate-45;
  }

  .menu__close i:after {
    @apply -rotate-45;
  }

  .menu__list {
    @apply list-none p-0 m-0;
  }

  .menu__item {
    @apply border-b border-primary-500 last:border-b-0;
  }

  .menu__link {
    @apply block px-4 py-3 text-bg hover:bg-primary-600 transition-colors duration-200 text-body font-normal capitalize no-underline;
  }

  /* Scale up menu link padding and font size on smaller screens */
  @media (max-width: 767px) {
    .menu__link {
      @apply px-[21px] py-[16px]; /* 16px * 1.3 = 20.8px, 12px * 1.3 = 15.6px, 16px * 1.3 = 20.8px */
    }
  }

  .menu__link:hover {
    @apply bg-primary-700 text-fg;
  }

  .menu__link.active {
    @apply bg-white text-bg;
  }

  .menu__social {
    @apply p-4 border-t border-primary-500 flex gap-4;
  }

  /* Scale up menu social section on smaller screens */
  @media (max-width: 767px) {
    .menu__social {
      @apply p-[21px] gap-[21px]; /* 16px * 1.3 = 20.8px */
    }
  }

  .menu__social a {
    @apply text-bg hover:text-gray-100 transition-colors duration-200;
  }

  .menu__social svg {
    @apply w-5 h-5;
  }

  /* Scale up social icons on smaller screens */
  @media (max-width: 767px) {
    .menu__social svg {
      @apply w-[26px] h-[26px]; /* 20px * 1.3 = 26px */
    }
  }
}

.ui-navbar {
  @apply fixed top-3 left-3 z-50;
}

.open-menu .ui-navbar {
  @apply z-[999];
}

/* Hide the old navigation structure when not needed */
.navigation {
  @apply hidden;
}

.open-menu .navigation {
  @apply hidden;
}

.branding {
  @apply relative;
}

.site-title,
.site-logo {
  @apply hidden;
}

.navigation .logo {
  @apply block w-[42px] h-auto my-0 mx-auto md:p-0 text-background;
}

.open-menu .navigation .logo {
  @apply hidden;
}

.navigation .logo path {
  @apply fill-current;
}

.navigation .navigation-list .logo {
  @apply w-[56px] md:w-[72px] ml-0 mr-auto;
}

.navigation .social {
  @apply flex gap-4 pl-4 font-serif text-body leading-tight;
}

.navigation .social p {
  @apply text-body text-muted leading-relaxed font-sans mr-4;
}

.navigation .social a {
  @apply text-highlight underline underline-offset-4;
}

.navigation .social svg {
  @apply fill-current;
}

/* ============================================
   SITE NAVBAR (Shared between homepage & internal pages)
   ============================================ */
.site-navbar {
  @apply fixed top-0 left-0 right-0 z-50 flex flex-col lg:flex-row items-center justify-between px-4 py-4 lg:px-12;
  background: transparent;
  transition: background-color 0.3s ease, transform 0.3s ease;
  transform: translateY(0);
}

.site-navbar.nav-hidden {
  transform: translateY(-100%);
}

/* Portfolio navbar: logo only, centered */
.site-navbar.portfolio-navbar {
  @apply justify-center;
}

.site-navbar.scrolled {
  background: rgba(30, 30, 30, 0.3);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

/* Homepage: light background when scrolled */
.home .site-navbar.scrolled {
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.site-navbar.scrolled .site-logo-img {
  filter: brightness(0) invert(1);
  transition: filter 0.3s ease;
}

/* Homepage: keep dark logo when scrolled */
.home .site-navbar.scrolled .site-logo-img {
  filter: brightness(0);
}

/* Homepage: dark text when scrolled */
.home .site-navbar.scrolled .nav-link {
  @apply text-primary-800;
}

.home .site-navbar.scrolled .nav-link:hover {
  @apply text-primary-900 no-underline;
}

.home .site-navbar.scrolled .site-logo-text {
  @apply text-primary-800;
}

/* Homepage: dark mobile menu button when scrolled */
.home .site-navbar.scrolled .mobile-menu-handle::before,
.home .site-navbar.scrolled .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.6);
}

.home .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::before,
.home .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.9);
}

.site-logo-link {
  @apply no-underline;
  opacity: 0;
  filter: blur(10px);
  transition: opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1), filter 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.site-logo-link.visible {
  opacity: 1;
  filter: blur(0px);
}

.site-logo-text {
  @apply text-white font-heading font-semibold tracking-tight no-underline;
  font-size: 1.5rem; /* 24px base */
  font-variation-settings: "wght" 600, "wdth" 125;
}

/* Reduce logo text size on large screens */
@media (min-width: 1024px) {
  .site-logo-text {
    font-size: 1.625rem; /* 26px on large screens */
  }
}

/* Homepage: dark text on light background */
.home .site-logo-text {
  @apply text-primary-800;
}

/* Portfolio pages: light text */
body.portfolio-page .site-logo-text,
body.portfolio-page .nav-link {
  @apply text-white;
}

body.portfolio-page .nav-link:hover {
  @apply text-white no-underline;
}

body.portfolio-page .site-logo-img path:first-child {
  fill: #ffffff;
}

body.portfolio-page .site-logo-img .design-text {
  fill: var(--color-accent) !important;
}

.site-logo-img {
  @apply h-7 w-auto;
  transition: filter 0.3s ease;
}

/* Homepage: dark logo on light background, but keep "design" text green */
.home .site-logo-img path:first-child {
  fill: #2b4831; /* primary-800 */
}

/* Keep "design" text green (accent color) on homepage */
.home .site-logo-img .design-text {
  fill: var(--color-accent) !important;
}

.nav-links {
  @apply hidden lg:flex items-center gap-8;
}

.nav-link {
  @apply text-white font-sans no-underline relative pb-2;
  font-size: 0.875rem; /* 14px base */
  font-weight: 300;
  opacity: 0;
  filter: blur(10px);
  transition: opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1), filter 0.4s cubic-bezier(0.16, 1, 0.3, 1), all 0.2s ease;
}

.nav-link.visible {
  opacity: 1;
  filter: blur(0px);
}

/* Reduce nav link size on large screens */
@media (min-width: 1024px) {
  .nav-link {
    font-size: 0.875rem; /* 14px on large screens */
  }
}

/* Homepage: dark text on light background */
.home .nav-link {
  @apply text-primary-800;
}

.nav-link:hover {
  @apply text-white no-underline;
}

/* Homepage: dark hover on light background */
.home .nav-link:hover {
  @apply text-primary-900 no-underline;
}

.nav-link.active {
  @apply font-bold;
}

.nav-link.active::after {
  content: "";
  @apply absolute bottom-0 left-0 right-0 h-[3px] bg-accent;
}

.nav-cta {
  @apply btn btn-sm;
  opacity: 0;
  filter: blur(10px);
  transition: opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1), filter 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.nav-cta.visible {
  opacity: 1;
  filter: blur(0px);
}

/* Portfolio pages: ensure nav CTA is visible */
body.portfolio-page .nav-cta {
  @apply text-accent;
}

/* Mobile Menu Button - sleek two-bar design */
.mobile-menu-btn {
  @apply lg:hidden absolute right-4 top-4 flex items-center justify-center cursor-pointer;
  width: 28px;
  height: 28px;
  background: transparent;
  border: none;
  padding: 0;
  z-index: 100;
}

.mobile-menu-handle {
  @apply block relative;
  width: 20px;
  height: 8px;
}

.mobile-menu-handle::before,
.mobile-menu-handle::after {
  content: "";
  @apply block absolute left-0;
  width: 20px;
  height: 1.5px;
  background: rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
}

/* Homepage: dark handle lines on light background */
.home .mobile-menu-handle::before,
.home .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.6);
}

/* Portfolio pages: light handle lines */
body.portfolio-page .mobile-menu-handle::before,
body.portfolio-page .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 0.8);
}

body.portfolio-page .mobile-menu-btn:hover .mobile-menu-handle::before,
body.portfolio-page .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 1);
}

.mobile-menu-handle::before {
  top: 0;
}

.mobile-menu-handle::after {
  bottom: 0;
}

.mobile-menu-btn:hover .mobile-menu-handle::before,
.mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 1);
}

/* Homepage: dark hover handle on light background */
.home .mobile-menu-btn:hover .mobile-menu-handle::before,
.home .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.9);
}

.mobile-menu-btn.open .mobile-menu-handle::before {
  top: 50%;
  transform: translateY(-50%) rotate(45deg);
}

.mobile-menu-btn.open .mobile-menu-handle::after {
  bottom: 50%;
  transform: translateY(50%) rotate(-45deg);
}

/* Responsive navbar adjustments */
@media (max-width: 1024px) {
  .nav-links {
    @apply hidden;
  }

  .nav-cta {
    @apply hidden lg:inline-flex;
  }
}

/* ============================================
   INTERNAL PAGE NAVBAR VARIANT
   Light background with dark text
   ============================================ */
body:not(.home):not(.portfolio-page) .site-navbar .nav-link {
  @apply text-gray-700;
}

body:not(.home):not(.portfolio-page) .site-navbar .nav-link:hover {
  @apply text-gray-900 no-underline;
}


body:not(.home):not(.portfolio-page) .site-navbar .mobile-menu-handle::before,
body:not(.home):not(.portfolio-page) .site-navbar .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.6);
}

body:not(.home):not(.portfolio-page) .site-navbar .mobile-menu-btn:hover .mobile-menu-handle::before,
body:not(.home):not(.portfolio-page) .site-navbar .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(0, 0, 0, 0.8);
}

/* When scrolled on internal pages, keep white text */
body:not(.home):not(.portfolio-page) .site-navbar.scrolled .nav-link {
  @apply text-white;
}

body:not(.home):not(.portfolio-page) .site-navbar.scrolled .nav-link:hover {
  @apply text-white no-underline;
}


body:not(.home):not(.portfolio-page) .site-navbar.scrolled .mobile-menu-handle::before,
body:not(.home):not(.portfolio-page) .site-navbar.scrolled .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 0.8);
}

body:not(.home):not(.portfolio-page) .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::before,
body:not(.home):not(.portfolio-page) .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 1);
}

/* Portfolio pages: always light navbar content */
body.portfolio-page .site-navbar .nav-link,
body.portfolio-page .site-navbar.scrolled .nav-link {
  @apply text-white;
}

body.portfolio-page .site-navbar .nav-link:hover,
body.portfolio-page .site-navbar.scrolled .nav-link:hover {
  @apply text-white no-underline;
}

body.portfolio-page .site-navbar .site-logo-text,
body.portfolio-page .site-navbar.scrolled .site-logo-text {
  @apply text-white;
}

body.portfolio-page .site-navbar .mobile-menu-handle::before,
body.portfolio-page .site-navbar .mobile-menu-handle::after,
body.portfolio-page .site-navbar.scrolled .mobile-menu-handle::before,
body.portfolio-page .site-navbar.scrolled .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 0.8);
}

body.portfolio-page .site-navbar .mobile-menu-btn:hover .mobile-menu-handle::before,
body.portfolio-page .site-navbar .mobile-menu-btn:hover .mobile-menu-handle::after,
body.portfolio-page .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::before,
body.portfolio-page .site-navbar.scrolled .mobile-menu-btn:hover .mobile-menu-handle::after {
  background: rgba(255, 255, 255, 1);
}

body.portfolio-page .site-navbar .site-logo-img path:first-child,
body.portfolio-page .site-navbar.scrolled .site-logo-img path:first-child {
  fill: #ffffff;
}

body.portfolio-page .site-navbar .site-logo-img .design-text,
body.portfolio-page .site-navbar.scrolled .site-logo-img .design-text {
  fill: var(--color-accent) !important;
}

/* ============================================
   MOBILE MENU (Pull-down Sheet)
   ============================================ */
.mobile-menu {
  @apply fixed left-0 right-0 z-[60] flex flex-col items-center lg:hidden top-0 bg-gray-950 py-10 px-6 rounded-b-2xl;
  transform: translateY(-100%);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
}

.mobile-menu.open {
  transform: translateY(0);
}

/* CTA button at top of menu */
.mobile-menu-cta {
  @apply mb-8;
}

.mobile-menu-cta .btn {
  @apply text-body py-4 px-6;
}

/* Navigation links */
.mobile-menu-links {
  @apply flex flex-col items-center gap-0 w-full;
}

.mobile-menu-link {
  @apply text-white font-heading no-underline py-3 text-center inline-block text-subheading;
  font-variation-settings: "wght" 300, "wdth" 125;
  opacity: 0;
  transition: opacity 0.2s ease, color 0.2s ease;
}

.mobile-menu-link.active {
  font-variation-settings: "wght" 700, "wdth" 125;
  position: relative;
}

.mobile-menu-link.active::after {
  content: "";
  @apply absolute left-0 h-[3px] rounded-full bg-accent;
  bottom: 6px;
  display: inline-block;
  width: 100%;
}

.mobile-menu.open .mobile-menu-link {
  opacity: 1;
}

/* Stagger the link animations */
.mobile-menu.open .mobile-menu-link:nth-child(1) {
  transition-delay: 0.08s;
}
.mobile-menu.open .mobile-menu-link:nth-child(2) {
  transition-delay: 0.12s;
}
.mobile-menu.open .mobile-menu-link:nth-child(3) {
  transition-delay: 0.16s;
}
.mobile-menu.open .mobile-menu-link:nth-child(4) {
  transition-delay: 0.2s;
}
.mobile-menu.open .mobile-menu-link:nth-child(5) {
  transition-delay: 0.24s;
}
.mobile-menu.open .mobile-menu-link:nth-child(6) {
  transition-delay: 0.28s;
}

.mobile-menu-link:hover,
.mobile-menu-link:active {
  @apply text-accent;
}

/* Logo at bottom of menu */
.mobile-menu-logo {
  @apply mt-8 text-white;
}

.mobile-menu-logo svg {
  height: 36px;
  width: auto;
}

.mobile-menu-logo svg path:first-child {
  fill: currentColor;
}

.mobile-menu-logo svg .design-text {
  fill: var(--color-accent);
}

/* Pull handle at bottom */
.mobile-menu-handle-bottom {
  @apply mt-6 rounded-full w-[26px] h-1 bg-white/40;
}

/* Overlay behind menu */
.mobile-menu-overlay {
  @apply fixed inset-0 bg-black/50 z-30 lg:hidden;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.mobile-menu-overlay.open {
  opacity: 1;
  visibility: visible;
}
